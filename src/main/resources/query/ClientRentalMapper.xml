<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.fly.client.place.dao.ClientPlaceDao">

	<!-- 구장 리스트 -->
	<select id="placeList" resultType="place" parameterType="String">
		select p_name, p_num
		from place
		where m_id = #{m_id} and p_status = 1
		order by p_regdate asc
	</select>
	
	<!-- 경기장 리스트 -->
	<select id="stadiumList" resultType="stadium" parameterType="place">
		select s_name, s_no
		from stadium
		where p_num = #{p_num}
	</select>

	<!-- 대관 리스트 -->
	<select id="rentalList" resultType="rental" parameterType="hashmap">
		select r_reserve_date
	    from rental
	    where s_no = #{s_no} and to_char(r_reserve_date, 'yyyy-MM-dd') = #{r_reserve_date}
	    <!-- <![CDATA[ '2019-10-01' ]]> -->
	</select>
	
	<!-- 환불 리스트 -->
	<select id="">
		SELECT r.m_id, (SELECT m_name from member where m_id = r.m_id), 
	    (SELECT p_name from place where p_num = (SELECT p_num from stadium where s_no = r.s_no) and m_id = #{m_id}), 
	    r.r_total_pay, r.refund, to_char(r.r_recall_time, 'yyyy/MM/dd') r_recall_time
		FROM rental r
		WHERE r.r_pay_status = -1
		ORDER BY r_recall_time desc
	</select>

</mapper>